<div id="training">
	<div class="step" ng-repeat="step in trainingSteps">
		<div class="simplex-table">
				<table>
					<thead>
						<tr>
							<th></th>
							<th ng-repeat="variable in step.data.lpp.fx">
								{{variable.name}}<sub>{{variable.index + 1}}</sub>
							</th>
							<th>b<sub>i</sub></th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="row in step.data.lpp.matrixA">
							<td>
								<select ng-class="{mistake: step.data.basis[$index].incorrect}" ng-options="item.displayName for item in step.variables | notSelectedVariables:step:$index" ng-model="step.data.basis[$index]" ng-change="setLimitationIndex(step.data.basis[$index], $index)">
							</td>
							<td ng-repeat="variable in row"
								ng-model="variable.value"
								m-format
								ng-class="{mistake: row[$index].value.incorrect, around: step.data.solvingElement.rowIndex === $parent.$index && step.data.solvingElement.colIndex === $index && step.nextAction === 'improvable'}"
								contenteditable
								ng-change="changeHandler()">{{variable.value.toString()}}</td>
							<td contenteditable 
								ng-class="{mistake: step.data.lpp.matrixB[$index].incorrect}"
								ng-model="step.data.lpp.matrixB[$index]"
								m-format>
								{{step.data.lpp.matrixB[$index].toString()}}
							</td>
							<td contenteditable ng-if="step.type === 'first-simplex-table'">
								{{step.data.lpp.fx[step.data.basis[$index].basisVariable._index].value.toString()}}
							</td>
						</tr>
						<tr>
							<td>f(x)</td>
							<td ng-repeat="value in step.data.lpp.fx"
								contenteditable
								ng-class="{mistake: step.data.lpp.matrixC[$index].incorrect}"
								ng-model="step.data.lpp.matrixC[$index]"
								m-format
								>{{step.data.lpp.matrixC[$index].toString()}}</td>
							<td ng-model="step.data.anglePoint.value"
								ng-class="{mistake: step.data.anglePoint.value.incorrect}"
								m-format
								contenteditable="true">{{step.data.anglePoint.value.toString()}}</td>
						</tr>
						<tr ng-if="step.type === 'first-simplex-table'">
							<td class="without-borders"></td>
							<td contenteditable ng-repeat="variable in step.data.lpp.fx">{{variable.value.toString()}}</td>
						</tr>
					</tbody>
				</table>

				<button title="Заповнити таблицю даними з попереднього кроку" ng-click="autoComplete(step.data)">Автозаповнення</button>

				<select class="action-choice" ng-class="{mistake: step.selectedIncorrectAction}" ng-options="action.type as action.text for action in actions" ng-model="step.nextAction" ng-change="compareAction()">
					<option value="">Виберіть наступну дію</option>
				</select>
				<div class="next-table-options" ng-show="step.nextAction === 'improvable'">
					<div class="select-flex-container">
						<div>
							<label>Розв'язуючий рядок</label>
							<select ng-init="step.data.solvingElement.rowIndex = rowIndexes[0].index" ng-options="item.index as (item.index + 1) for item in rowIndexes" ng-model="step.data.solvingElement.rowIndex">
							</select>
						</div>
						<div>
							<label>Розв'язуючий стовпчик</label>
							<select ng-init="step.data.solvingElement.colIndex = colIndexes[0].index" ng-options="item.index as (item.index + 1) for item in colIndexes" ng-model="step.data.solvingElement.colIndex">
							</select>
						</div>							
					</div>
					<div class="select-flex-container">
					<div>
						<label>Змінна, яка виводиться з базису</label>
						<select ng-init="step.removedFromBasis = step.data.basis[0]" ng-options="item.displayName for item in step.data.basis" ng-model="step.removedFromBasis"></select>
					</div>
					<div>
						<label>Змінна, яка вводиться в базис</label>
						<select ng-init="step.addedToBasis = (step.variables | notBasisVariables:step)[0]" ng-options="item.displayName for item in step.variables | notBasisVariables:step" ng-model="step.addedToBasis"></select>
						</div>
					</div>					
				</div>
				<button ng-hide="step.selectedIncorrectAction || !step.nextAction" ng-click="confirm()">OK</button>
			</div>
	</div>
</div>